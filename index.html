<!DOCTYPE HTML>
<html>
	<head>
		<title>Fitness Express OZ</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

		<!-- FontAwesome - http://fortawesome.github.io/Font-Awesome/ -->
		<link rel="stylesheet" href="css/font-awesome.min.css" />

		<!-- jQueryMobileCSS - original without styling -->
		<link rel="stylesheet" href="css/jquerymobile.css" />

		<!-- nativeDroid core CSS -->
		<link rel="stylesheet" href="css/jquerymobile.nativedroid.css" />

		<!-- nativeDroid: Light/Dark -->
		<link rel="stylesheet" href="css/jquerymobile.nativedroid.dark.css"  id='jQMnDTheme' />

		<!-- nativeDroid: Color Schemes -->
		<link rel="stylesheet" href="css/jquerymobile.nativedroid.color.green.css" id='jQMnDColor' />

		<!--custom css-->
		<link rel="stylesheet" href="css/style.css" />
		<!-- <link rel="stylesheet" href="css/media-query.css" /> -->

		<!-- jQuery / jQueryMobile Scripts -->
		<script src="js/jquery-1.10.2.min.js"></script>
  		<script src="js/jquery.mobile-1.4.2.min.js"></script>
        
        <script src="js/jquery.min.js"></script>
        <script src="js/logger.js"></script>
        <script src="cordova.js"></script>
		<script src="PushNotification.js"></script>
		
		<script src="js/functions.js"></script>
        
        <script type="text/javascript">
            var pushNotification;
            
			function callbackAppid(data) {
				alert('Posted successfully');
							
			}	
            // handle GCM notifications for Android
			
            function onDeviceReady() {
            	alert('device ready');
                $("#app-status-ul").append('<li>deviceready event received</li>');
                
				document.addEventListener("backbutton", function(e)
				{
                	$("#app-status-ul").append('<li>backbutton event received</li>');
  					
      				if( $("#home").length > 0)
					{
						// call this to get a new token each time. don't call it to reuse existing token.
						//pushNotification.unregister(successHandler, errorHandler);
						e.preventDefault();
						navigator.app.exitApp();
					}
					else
					{
						navigator.app.backHistory();
					}
				}, false);
			
				try 
				{ 
                	pushNotification = window.plugins.pushNotification;
                	if (device.platform == 'android' || device.platform == 'Android') {
						$("#app-status-ul").append('<li>registering android</li>');
                    	pushNotification.register(successHandler, errorHandler, {"senderID":"325770691942","ecb":"onNotificationGCM"});		// required!
						pushNotification.setApplicationIconBadgeNumber(this.successHandler, 0);
					} else {
						$("#app-status-ul").append('<li>registering iOS</li>');
                    	pushNotification.register(tokenHandler, errorHandler, {"badge":"true","sound":"true","alert":"true","ecb":"onNotificationAPN"});	// required!
                	}
					//alert(device.platform);

                }
				catch(err) 
				{ 
					txt="There was an error on this page.\n\n"; 
					txt+="Error description: " + err.message + "\n\n"; 
					alert(txt); 
				} 
            }
            
            // handle APNS notifications for iOS
            function onNotificationAPN(e) {
                if (e.alert) {
                     $("#app-status-ul").append('<li>push-notification: ' + e.alert + '</li>');
                     navigator.notification.alert(e.alert);
                }
                    
                if (e.sound) {
                    var snd = new Media(e.sound);
                    snd.play();
                }
                
                if (e.badge) {
                    pushNotification.setApplicationIconBadgeNumber(successHandler, e.badge);
                }
            }

            function onNotificationGCM(e) {
                $("#app-status-ul").append('<li>EVENT -> RECEIVED:' + e.event + '</li>');
                
                switch( e.event )
                {
                    case 'registered':
					if ( e.regid.length > 0 ) {
						alert(e.regid);
						params = {callback: 'callbackAppid', controller: 'Jobs', action: 'appid', idText: e.regid };
						getAjaxData(params, 'callbackAppid');
						
						//$("#app-status-ul").append('<li>REGISTERED -> REGID:' + e.regid + "</li>");
						// Your GCM push server needs to know the regID before it can push to this device
						// here is where you might want to send it the regID for later use.
						//console.log("regID = " + e.regid);							
					}

                    break;
                    
                    case 'message':
                    	// if this flag is set, this notification happened while we were in the foreground.
                    	// you might want to play a sound to get the user's attention, throw up a dialog, etc.
                    	if (e.foreground)
                    	{
							$("#app-status-ul").append('<li>--INLINE NOTIFICATION--' + '</li>');
							
							// if the notification contains a soundname, play it.
							var my_media = new Media("/android_asset/www/"+e.soundname);
							my_media.play();
						}
						else
						{	// otherwise we were launched because the user touched a notification in the notification tray.
							if (e.coldstart)
								$("#app-status-ul").append('<li>--COLDSTART NOTIFICATION--' + '</li>');
							else
							$("#app-status-ul").append('<li>--BACKGROUND NOTIFICATION--' + '</li>');
						}
							
						$("#app-status-ul").append('<li>MESSAGE -> MSG: ' + e.payload.message + '</li>');
						$("#app-status-ul").append('<li>MESSAGE -> MSGCNT: ' + e.payload.msgcnt + '</li>');
                    break;
                    
                    case 'error':
						$("#app-status-ul").append('<li>ERROR -> MSG:' + e.msg + '</li>');
                    break;
                    
                    default:
						$("#app-status-ul").append('<li>EVENT -> Unknown, an event was received and we do not know what it is</li>');
                    break;
                }
            }
            
            function tokenHandler (result) {
                $("#app-status-ul").append('<li>token: '+ result +'</li>');
                // Your iOS push server needs to know the token before it can push to this device
                // here is where you might want to send it the token for later use.
            }
			
            function successHandler (result) {
                $("#app-status-ul").append('<li>success:'+ result +'</li>');
            }
            
            function errorHandler (error) {
                $("#app-status-ul").append('<li>error:'+ error +'</li>');
            }
            
			document.addEventListener('deviceready', onDeviceReady, true);

         </script>
        <script type="text/javascript">

		$(document).on("pagecreate","#login-page",function(){

					
			
			hideMessgae();

			$( ".footer" ).toolbar({ tapToggle: false });
			
		 $( "#submitForLogin" ).click(function(event) {
			event.preventDefault();
			submitForm("#login");
			});		
		  allowAccess();
		
		});
		
		function callbackLogin(data) {
			if(data.success == true && data.data != null) {
				setLoginState(data);
				location.replace('dashboard.html');
			} else if (data.success == false && data.data == null ){
				showMessage(data);
			}
		}
		</script>

	</head>
	<body>

		<div data-role="page" id="login-page" data-theme='b'>
        <div id="page_wrapper">

			<div data-role="header" data-position="fixed" data-tap-toggle="false" data-theme='b'>
				<a href="#">
					<img src="image/logo.png" alt="logo" />
				</a>
				<h1>Fitness Express OZ</h1>
			</div>
			<div data-role="content">

			<div id="pageTitle"><i class="icon-lock"></i> User Login</div>
				<div class="my-profile-bg content-position">
					
                    <div class='input-container' id="result"></div>
                      <!--onsubmit="submitForm(this)"-->
                    <div style="clear:both"></div>
					<form id="login" method="post" action="#">

						<div class='input-container'>
							<div class="icon-ph">
								<i class='icon-user'></i>
							</div>
							<input class="custom-text" type="text" placeholder="Username" name="data[User][username]" data-role="none">
						</div>
						<div class='input-container'>
							<div class="icon-ph">
								<i class='icon-key'></i>
							</div>
							<input class="custom-text" type="password" placeholder="Password" name="data[User][password]" data-role="none">
						</div>

						<input type="hidden" name='controller' value="Users"  />
						<input type="hidden" name='action' value="login"  />
						<input type="hidden" name='callback' value="callbackLogin" />

						<div class='input-container'>
							<button type="submit" id="submitForLogin" class="login-width" data-role="none">
								Login
							</button>
						</div>
					</form>
                     
							<a class="regis" href="register.html" data-role="none" data-ajax="false">
								Not a user, register Here  
							</a>
                         
						
				</div>


				<div style="clear:both"></div>
			</div>
			<div data-role="footer" data-position="fixed" data-id="foo1" class="footer">
				<div class="social-i" align="middle">
					<a href="https://www.facebook.com/FitExpressOz"><i class='icon-facebook'></i></a>
					<a href="http://instagram.com/fitnessexpress_oz"><i class='icon-instagram'></i></a>
					<a href="mailto:info@fitnessexpressoz.com" target="_top"><i class='icon-envelope-alt'></i></a>
				</div>
				<div class="" align="middle">
					Ph: 1300 00 9777
				</div>
			</div><!-- /footer -->

		</div>
        </div>

	</body>
</html>
